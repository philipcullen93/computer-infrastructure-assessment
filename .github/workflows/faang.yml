name: Run FAANG Script Every Saturday

# --------------------------------------------------
# Trigger:
#   - schedule: Runs every Saturday at 07:00 UTC
#   - workflow_dispatch: Allows manual run
# --------------------------------------------------
on:
  schedule:
    - cron: "0 7 * * 6"     # 6 = Saturday (0=Sun, 6=Sat)
  workflow_dispatch:

jobs:
  run-faang:
    runs-on: ubuntu-latest

    steps:

      # --------------------------------------------------
      # Step 1 — Checkout repo so workflow can access files
      # --------------------------------------------------
      - name: Checkout repository
        uses: actions/checkout@v4

      # --------------------------------------------------
      # Step 2 — Install Python
      # --------------------------------------------------
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      # --------------------------------------------------
      # Step 3 — Install Python dependencies
      # --------------------------------------------------
      - name: Install dependencies
        run: |
          echo "Installing Python dependencies..."
          pip install yfinance pandas matplotlib

      # --------------------------------------------------
      # Step 4 — Run FAANG script (with echo = print)
      # --------------------------------------------------
      - name: Run FAANG script
        run: |
          echo "----------------------------------------"
          echo "Starting FAANG script run"
          echo "Time: $(date)"
          echo "----------------------------------------"
          chmod +x faang.py
          ./faang.py
          echo "----------------------------------------"
          echo "FAANG script completed successfully!"
          echo "Output saved to data/ and plots/ folders"
          echo "----------------------------------------"

      # --------------------------------------------------
      # Step 5 — Upload CSV outputs as artifacts
      # --------------------------------------------------
      - name: Upload CSV output
        uses: actions/upload-artifact@v4
        with:
          name: faang-csv
          path: data/*.csv

      # --------------------------------------------------
      # Step 6 — Upload plot output as artifacts
      # --------------------------------------------------
      - name: Upload plot output
        uses: actions/upload-artifact@v4
        with:
          name: faang-plot
          path: plots/*.png
